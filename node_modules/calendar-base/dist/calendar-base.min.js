(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.calendarBase=f()}})(function(){var define,module,exports;module={exports:exports={}};function Calendar(options){options=options||{};this.startDate=options.startDate;this.endDate=options.endDate;this.siblingMonths=options.siblingMonths;this.weekNumbers=options.weekNumbers;this.weekStart=options.weekStart;if(this.weekStart===undefined){this.weekStart=0}}Calendar.prototype.getCalendar=function(year,month){var date=new Date(Date.UTC(year,month,1,0,0,0,0));year=date.getUTCFullYear();month=date.getUTCMonth();var calendar=[],firstDay=date.getUTCDay(),firstDate=-((7-this.weekStart+firstDay)%7),lastDate=Calendar.daysInMonth(year,month),lastDay=(lastDate-firstDate)%7,lastDatePreviousMonth=Calendar.daysInMonth(year,month-1),i=firstDate,max=lastDate-i+(lastDay!=0?7-lastDay:0)+firstDate,currentDay,currentDate,currentDateObject,currentWeekNumber=null,otherMonth,otherYear;while(i<max){currentDate=i+1;currentDay=((i<1?7+i:i)+firstDay)%7;if(currentDate<1||currentDate>lastDate){if(this.siblingMonths){if(currentDate<1){otherMonth=month-1;otherYear=year;if(otherMonth<0){otherMonth=11;otherYear--}currentDate=lastDatePreviousMonth+currentDate}else if(currentDate>lastDate){otherMonth=month+1;otherYear=year;if(otherMonth>11){otherMonth=0;otherYear++}currentDate=i-lastDate+1}currentDateObject={day:currentDate,weekDay:currentDay,month:otherMonth,year:otherYear,siblingMonth:true}}else{currentDateObject=false}}else{currentDateObject={day:currentDate,weekDay:currentDay,month:month,year:year}}if(currentDateObject&&this.weekNumbers){if(currentWeekNumber===null){currentWeekNumber=Calendar.calculateWeekNumber(currentDateObject)}else if(currentDay==1&&currentWeekNumber==52){currentWeekNumber=1}else if(currentDay==1){currentWeekNumber++}currentDateObject.weekNumber=currentWeekNumber}if(currentDateObject&&this.startDate){currentDateObject.selected=this.isDateSelected(currentDateObject)}calendar.push(currentDateObject);i++}return calendar};Calendar.prototype.isDateSelected=function(date){if(date.year==this.startDate.year&&date.month==this.startDate.month&&date.day==this.startDate.day){return true}else if(this.endDate){if(date.year==this.startDate.year&&date.month==this.startDate.month&&date.day<this.startDate.day){return false}else if(date.year==this.endDate.year&&date.month==this.endDate.month&&date.day>this.endDate.day){return false}else if(date.year==this.startDate.year&&date.month<this.startDate.month){return false}else if(date.year==this.endDate.year&&date.month>this.endDate.month){return false}else if(date.year<this.startDate.year){return false}else if(date.year>this.endDate.year){return false}return true}return false};Calendar.prototype.setStartDate=function(date){this.startDate=date};Calendar.prototype.setEndDate=function(date){this.endDate=date};Calendar.prototype.setDate=Calendar.prototype.setStartDate;Calendar.diff=function(date1,date2){date1=new Date(Date.UTC(date1.year,date1.month,date1.day,0,0,0,0));date2=new Date(Date.UTC(date2.year,date2.month,date2.day,0,0,0,0));return Math.ceil((date1.getTime()-date2.getTime())/864e5)};Calendar.interval=function(date1,date2){return Math.abs(Calendar.diff(date1,date2))+1};Calendar.compare=function(leftDate,rightDate){if(typeof leftDate!="object"||typeof rightDate!="object"||leftDate===null||rightDate===null){throw new TypeError("dates must be objects")}if(leftDate.year<rightDate.year){return-1}else if(leftDate.year>rightDate.year){return 1}else if(leftDate.month<rightDate.month){return-1}else if(leftDate.month>rightDate.month){return 1}else if(leftDate.day<rightDate.day){return-1}else if(leftDate.day>rightDate.day){return 1}return 0};Calendar.daysInMonth=function(year,month){return new Date(year,month+1,0).getDate()};Calendar.isLeapYear=function(year){return year%4==0&&year%100!=0||year%400==0};Calendar.calculateWeekNumber=function(date){var current=new Date(Date.UTC(date.year,date.month,date.day,0,0,0,0));var target=new Date(current.valueOf());var dayNr=(current.getUTCDay()+6)%7;target.setUTCDate(target.getUTCDate()-dayNr+3);var firstThursday=target.valueOf();target.setUTCMonth(0,1);if(target.getUTCDay()!=4){target.setUTCMonth(0,1+(4-target.getUTCDay()+7)%7)}return 1+Math.ceil((firstThursday-target)/6048e5)};module.exports={Calendar:Calendar};return module.exports});
